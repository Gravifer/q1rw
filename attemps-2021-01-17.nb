(* Content-type: application/vnd.wolfram.mathematica *)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Meta-settings", "Section"],

Cell[BoxData["$Version"], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Charting`ResolvePlotTheme", "[",
   RowBox[{"Automatic", ",", "VectorPlot"}], "]"}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"vcf", "=",
   InterpretationBox[
    RowBox[{
     TagBox["ColorDataFunction",
      "SummaryHead"], "[",
     DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ =
      "Ready"},
      TemplateBox[{
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]],
                 ButtonFunction :> (Typeset`open$$ = True), Appearance ->
                None, BaseStyle -> {}, Evaluator -> Automatic, Method ->
                "Preemptive"], Alignment -> {Center, Center}, ImageSize ->
               Dynamic[{
                 Automatic,
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]],
              GridBox[{{
                 RowBox[{
                   TagBox["\"Name: \"", "SummaryItemAnnotation"],
                   "\[InvisibleSpace]",
                   TagBox["\"WL12DefaultVectorGradient\"", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Gradient: \"", "SummaryItemAnnotation"],
                   "\[InvisibleSpace]",
                   TagBox[
                    StyleBox[
                    GraphicsBox[{
                    RasterBox[CompressedData["
1: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
                    "], {{0, 0}, {1, 1}}]}, {
                    ImageSize -> 65, BaselinePosition -> Bottom, AspectRatio ->
                    NCache[
                    Rational[1, 8], 0.125], PlotRange -> {{0, 1}, {0, 1}}}],
                    Selectable -> False, StripOnInput -> False],
                    "SummaryItem"]}]}},
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete ->
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}},
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False,
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}},
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}},
            AutoDelete -> False,
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]],
                 ButtonFunction :> (Typeset`open$$ = False), Appearance ->
                None, BaseStyle -> {}, Evaluator -> Automatic, Method ->
                "Preemptive"], Alignment -> {Center, Center}, ImageSize ->
               Dynamic[{
                 Automatic,
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]],
              GridBox[{{
                 RowBox[{
                   TagBox["\"Name: \"", "SummaryItemAnnotation"],
                   "\[InvisibleSpace]",
                   TagBox["\"WL12DefaultVectorGradient\"", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Gradient: \"", "SummaryItemAnnotation"],
                   "\[InvisibleSpace]",
                   TagBox[
                    StyleBox[
                    GraphicsBox[{
                    RasterBox[CompressedData["
1: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
                    "], {{0, 0}, {1, 1}}]}, {
                    ImageSize -> 65, BaselinePosition -> Bottom, AspectRatio ->
                    NCache[
                    Rational[1, 8], 0.125], PlotRange -> {{0, 1}, {0, 1}}}],
                    Selectable -> False, StripOnInput -> False],
                    "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Domain: \"", "SummaryItemAnnotation"],
                   "\[InvisibleSpace]",
                   TagBox[
                    RowBox[{"{",
                    RowBox[{"0", ",", "1"}], "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Class: \"", "SummaryItemAnnotation"],
                   "\[InvisibleSpace]",
                   TagBox["\"ThemeGradients\"", "SummaryItem"]}]}},
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete ->
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}},
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False,
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}},
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}},
            AutoDelete -> False,
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
            BaselinePosition -> {1, 1}]},
         Dynamic[Typeset`open$$], ImageSize -> Automatic]},
       "SummaryPanel"],
      DynamicModuleValues:>{}], "]"}],
    ColorDataFunction[
    "WL12DefaultVectorGradient", "ThemeGradients", {0, 1}, Blend[
     "WL12DefaultVectorGradient", #]& ],
    Editable->False,
    SelectWithContents->True,
    Selectable->False]}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Monitor`NestList", "[",
   RowBox[{"f_", ",", "init_", ",", "n_"}], "]"}], ":=",
  RowBox[{"Module", "[",
   RowBox[{
    RowBox[{"{",
     RowBox[{"it", "=", "0"}], "}"}], ",",
    RowBox[{
     RowBox[{"PrintTemporary", "[",
      RowBox[{"ProgressIndicator", "[",
       RowBox[{"Dynamic", "[",
        RowBox[{"it", "/", "n"}], "]"}], "]"}], "]"}], ";",
     "\[IndentingNewLine]",
     RowBox[{"NestList", "[",
      RowBox[{
       RowBox[{
        RowBox[{"(",
         RowBox[{
          RowBox[{"it", "++"}], ";",
          RowBox[{"f", "[", "#", "]"}]}], ")"}], "&"}], ",", "init", ",",
       "n"}], "]"}]}]}], "]"}]}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"(*",
   RowBox[{
    RowBox[{"WFQTransit", "[",
     RowBox[{"weights_List", ",",
      RowBox[{"relaxation_", ":", "0"}]}], "]"}], ":=",
    RowBox[{"Function", "[",
     RowBox[{"state", ",",
      RowBox[{"RandomChoice", "[",
       RowBox[{"weights", "\[RuleDelayed]",
        RowBox[{"(",
         RowBox[{
          RowBox[{
           RowBox[{"(",
            RowBox[{"#", "+", "state"}], ")"}], "&"}], "/@",
          RowBox[{"(",
           RowBox[{
            RowBox[{"IdentityMatrix", "[", "Length", "]"}], "~", "Join", "~",
            RowBox[{"(",
             RowBox[{"-",
              RowBox[{"IdentityMatrix", "[",
               RowBox[{"Length", "[", "state", "]"}], "]"}]}], ")"}]}],
           ")"}]}], ")"}]}], "]"}]}], "]"}]}], "*)"}]}]}], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell["Test for \:0418\:0437\:0436\:043e \:041b\:044e", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "4"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"Normal", "@",
   RowBox[{"SparseArray", "[",
    RowBox[{
     RowBox[{"{",
      RowBox[{
       RowBox[{
        RowBox[{"{",
         RowBox[{"i_", ",", "j_"}], "}"}], "/;",
        RowBox[{"j", ">", "i"}]}], "\[RuleDelayed]",
       SuperscriptBox["\[ExponentialE]",
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], "*",
         FractionBox["\[Pi]", "4"]}]]}], "}"}], ",",
     RowBox[{"{",
      RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"mat", "=",
   RowBox[{"%", "+",
    RowBox[{"%", "\[ConjugateTranspose]"}], "+",
    RowBox[{"IdentityMatrix", "[", "n", "]"}]}]}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{"Clear", "[", "n", "]"}], "\[IndentingNewLine]",
 RowBox[{"mat", "//", "MatrixForm"}], "\[IndentingNewLine]",
 RowBox[{"PositiveSemidefiniteMatrixQ", "@", "mat"}]}], "Input"]
}]]
}]]
}]],

Cell[CellGroupData[{

Cell["Soft transitter", "Section"],

Cell[CellGroupData[{

Cell["Basic Idea", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ComplexPlot3D", "[",
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(",
      RowBox[{"1", "+",
       SuperscriptBox["\[ExponentialE]",
        RowBox[{"-",
         RowBox[{"Im", "@", "z"}]}]]}], ")"}],
     RowBox[{"(",
      RowBox[{"1", "-",
       SuperscriptBox["\[ExponentialE]",
        RowBox[{"-",
         RowBox[{"Re", "@", "z"}]}]]}], ")"}]}], "+",
    RowBox[{"\[ImaginaryI]",
     RowBox[{"(",
      RowBox[{"1", "+",
       SuperscriptBox["\[ExponentialE]",
        RowBox[{"-",
         RowBox[{"Re", "@", "z"}]}]]}], ")"}],
     RowBox[{"(",
      RowBox[{"1", "-",
       SuperscriptBox["\[ExponentialE]",
        RowBox[{"-",
         RowBox[{"Im", "@", "z"}]}]]}], ")"}]}]}], ",",
   RowBox[{"{",
    RowBox[{"z", ",",
     RowBox[{"0", "*",
      RowBox[{"(",
       RowBox[{"1", "+", " ", "\[ImaginaryI]"}], ")"}]}], ",",
     RowBox[{"2", "\[ExponentialE]", "*",
      RowBox[{"(",
       RowBox[{"1", "+", " ", "\[ImaginaryI]"}], ")"}]}]}], "}"}], ",",
   RowBox[{"ColorFunction", "\[Rule]",
    RowBox[{"(",
     RowBox[{
      RowBox[{"Hue", "[",
       RowBox[{"2.95", "*",
        RowBox[{"(",
         RowBox[{"#8", "+", "0.5"}], ")"}]}], "]"}], "&"}], ")"}]}], ",",
   RowBox[{"PlotLegends", "\[Rule]",
    RowBox[{"BarLegend", "[", "\"\<Rainbow\>\"", "]"}]}], ",",
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",",
   RowBox[{"Mesh", "\[Rule]", "Full"}]}], "]"}]], "Input"]
}]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Simplify", "[",
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(",
       RowBox[{"1", "+",
        SuperscriptBox["\[ExponentialE]",
         RowBox[{"-",
          RowBox[{"Im", "@", "z"}]}]]}], ")"}],
      RowBox[{"(",
       RowBox[{"1", "-",
        SuperscriptBox["\[ExponentialE]",
         RowBox[{"-",
          RowBox[{"Re", "@", "z"}]}]]}], ")"}]}], "+",
     RowBox[{"\[ImaginaryI]",
      RowBox[{"(",
       RowBox[{"1", "+",
        SuperscriptBox["\[ExponentialE]",
         RowBox[{"-",
          RowBox[{"Re", "@", "z"}]}]]}], ")"}],
      RowBox[{"(",
       RowBox[{"1", "-",
        SuperscriptBox["\[ExponentialE]",
         RowBox[{"-",
          RowBox[{"Im", "@", "z"}]}]]}], ")"}]}]}], "/.",
    RowBox[{"z", "\[Rule]",
     RowBox[{"(",
      RowBox[{"a", "+",
       RowBox[{"\[ImaginaryI]", " ", "b"}]}], ")"}]}]}], "]"}], "/.",
  RowBox[{"{",
   RowBox[{
    RowBox[{
     RowBox[{"Im", "[", "a", "]"}], "\[Rule]", "0"}], ",",
    RowBox[{
     RowBox[{"Im", "[", "b", "]"}], "\[Rule]", "0"}], ",",
    RowBox[{
     RowBox[{"Re", "[", "a", "]"}], "\[Rule]", "a"}], ",",
    RowBox[{
     RowBox[{"Re", "[", "b", "]"}], "\[Rule]", "b"}], ",",
    RowBox[{
     RowBox[{"Re", "[",
      RowBox[{"a", "+", "b"}], "]"}], "\[Rule]",
     RowBox[{"a", "+", "b"}]}]}], "}"}]}], "\[IndentingNewLine]",
 RowBox[{"%", "//", "Expand"}]}], "Input"]
}]]
}]],

Cell[CellGroupData[{

Cell["Visualization of the softness", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[",
  RowBox[{
   RowBox[{"VectorPlot", "[",
    RowBox[{
     RowBox[{"-",
      RowBox[{"{",
       RowBox[{
        RowBox[{
         RowBox[{"(",
          RowBox[{"1", "-",
           SuperscriptBox["\[ExponentialE]",
            RowBox[{
             RowBox[{"-", "x"}], "/", "n0"}]]}], ")"}],
         RowBox[{"(",
          RowBox[{"1", "+",
           SuperscriptBox["\[ExponentialE]",
            RowBox[{
             RowBox[{"-", "y"}], "/", "n0"}]]}], ")"}]}], ",",
        RowBox[{
         RowBox[{"(",
          RowBox[{"1", "+",
           SuperscriptBox["\[ExponentialE]",
            RowBox[{
             RowBox[{"-", "x"}], "/", "n0"}]]}], ")"}],
         RowBox[{"(",
          RowBox[{"1", "-",
           SuperscriptBox["\[ExponentialE]",
            RowBox[{
             RowBox[{"-", "y"}], "/", "n0"}]]}], ")"}]}]}], "}"}]}], ",",
     RowBox[{"{",
      RowBox[{"x", ",", "0", ",", "5"}], "}"}], ",",
     RowBox[{"{",
      RowBox[{"y", ",", "0", ",", "5"}], "}"}], ",", " ",
     RowBox[{"VectorPoints", "\[Rule]",
      RowBox[{"Tuples", "[",
       RowBox[{
        RowBox[{"Range", "[",
         RowBox[{"0", ",", "5"}], "]"}], ",", "2"}], "]"}]}], ",",
     RowBox[{"VectorMarkers", "\[Rule]", "\"\<Drop\>\""}], ",",
     RowBox[{"VectorScaling", "\[Rule]", "Automatic"}], ",",
     RowBox[{"VectorRange", "\[Rule]", "All"}], ",",
     RowBox[{"VectorColorFunction", "\[Rule]",
      RowBox[{"(",
       RowBox[{
        RowBox[{"vcf", "[",
         RowBox[{"#5", "/", "2"}], "]"}], "&"}], ")"}]}], ",",
     RowBox[{"VectorColorFunctionScaling", "\[Rule]", "False"}], ",",
     RowBox[{"PlotLegends", "\[Rule]",
      RowBox[{"BarLegend", "[",
       RowBox[{"{",
        RowBox[{
         RowBox[{"(",
          RowBox[{
           RowBox[{"vcf", "[",
            RowBox[{"#", "/", "2"}], "]"}], "&"}], ")"}], ",",
         RowBox[{"{",
          RowBox[{"0", ",", "2"}], "}"}]}], "}"}], "]"}]}], ",",
     RowBox[{"Epilog", "\[Rule]",
      RowBox[{"{",
       RowBox[{
        RowBox[{"vcf", "[", "0", "]"}], ",",
        RowBox[{"Point", "[",
         RowBox[{"{",
          RowBox[{"0", ",", "0"}], "}"}], "]"}]}], "}"}]}]}], "]"}], ",",
   RowBox[{"{",
    RowBox[{
     RowBox[{"{",
      RowBox[{"n0", ",", "1"}], "}"}], ",", "0.1", ",", "20"}], "}"}]}],
  "]"}]], "Input"]
}]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[",
  RowBox[{
   RowBox[{"VectorPlot3D", "[",
    RowBox[{
     RowBox[{"-",
      RowBox[{"{",
       RowBox[{
        RowBox[{
         RowBox[{"(",
          RowBox[{"1", "+",
           SuperscriptBox["\[ExponentialE]",
            RowBox[{
             RowBox[{"-", "y"}], "/", "n0"}]], "+",
           SuperscriptBox["\[ExponentialE]",
            RowBox[{
             RowBox[{"-", "z"}], "/", "n0"}]]}], ")"}],
         RowBox[{"(",
          RowBox[{"1", "-",
           SuperscriptBox["\[ExponentialE]",
            RowBox[{
             RowBox[{"-", "x"}], "/", "n0"}]]}], ")"}]}], ",",
        RowBox[{
         RowBox[{"(",
          RowBox[{"1", "+",
           SuperscriptBox["\[ExponentialE]",
            RowBox[{
             RowBox[{"-", "x"}], "/", "n0"}]], "+",
           SuperscriptBox["\[ExponentialE]",
            RowBox[{
             RowBox[{"-", "z"}], "/", "n0"}]]}], ")"}],
         RowBox[{"(",
          RowBox[{"1", "-",
           SuperscriptBox["\[ExponentialE]",
            RowBox[{
             RowBox[{"-", "y"}], "/", "n0"}]]}], ")"}]}], ",",
        RowBox[{
         RowBox[{"(",
          RowBox[{"1", "+",
           SuperscriptBox["\[ExponentialE]",
            RowBox[{
             RowBox[{"-", "x"}], "/", "n0"}]], "+",
           SuperscriptBox["\[ExponentialE]",
            RowBox[{
             RowBox[{"-", "y"}], "/", "n0"}]]}], ")"}],
         RowBox[{"(",
          RowBox[{"1", "-",
           SuperscriptBox["\[ExponentialE]",
            RowBox[{
             RowBox[{"-", "z"}], "/", "n0"}]]}], ")"}]}]}], "}"}]}], ",",
     RowBox[{"{",
      RowBox[{"x", ",", "0", ",", "3"}], "}"}], ",",
     RowBox[{"{",
      RowBox[{"y", ",", "0", ",", "3"}], "}"}], ",",
     RowBox[{"{",
      RowBox[{"z", ",", "0", ",", "3"}], "}"}], ",", " ",
     RowBox[{"VectorPoints", "\[Rule]",
      RowBox[{"Tuples", "[",
       RowBox[{
        RowBox[{"Range", "[",
         RowBox[{"0", ",", "3"}], "]"}], ",", "3"}], "]"}]}]}], "]"}], ",",
   RowBox[{"{",
    RowBox[{
     RowBox[{"{",
      RowBox[{"n0", ",", "1"}], "}"}], ",", "0.0001", ",", "5"}], "}"}]}],
  "]"}]], "Input"]
}]]
}]]
}]],

Cell[CellGroupData[{

Cell["Time-regime simulation", "Section"],

Cell[CellGroupData[{

Cell["Verification of Convergence", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Transit", "[",
   RowBox[{"n_", ",",
    RowBox[{"n0_", ":", "1"}]}], "]"}], ":=",
  RowBox[{"RandomChoice", "[",
   RowBox[{
    RowBox[{"{",
     RowBox[{"1", ",",
      RowBox[{"2",
       RowBox[{"(",
        RowBox[{"1", "-",
         SuperscriptBox["\[ExponentialE]",
          RowBox[{
           RowBox[{"-", "n"}], "/", "n0"}]]}], ")"}]}]}], "}"}],
    "\[RuleDelayed]",
    RowBox[{"{",
     RowBox[{
      RowBox[{"n", "+", "1"}], ",",
      RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"myhist", "[", "ls_", "]"}], ":=",
  RowBox[{"BarChart", "[",
   RowBox[{
    RowBox[{"MeanAround", "/@",
     RowBox[{"(",
      RowBox[{
       RowBox[{"Transpose", "@",
        RowBox[{"PadRight", "[",
         RowBox[{
          RowBox[{
           RowBox[{"(",
            RowBox[{"HistogramList", "/@",
             RowBox[{"Partition", "[",
              RowBox[{"ls", ",",
               RowBox[{"Floor", "[",
                RowBox[{"Sqrt", "[",
                 RowBox[{"Length", "[", "ls", "]"}], "]"}], "]"}]}], "]"}]}],
            ")"}], "\[LeftDoubleBracket]",
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",",
          "Automatic", ",", "\"\<\>\""}], "]"}]}], "/.",
       RowBox[{"\"\<\>\"", "\[Rule]", "Nothing"}]}], ")"}]}], ",",
    RowBox[{"BarSpacing", "\[Rule]", "None"}]}], "]"}]}]}], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ls1", "=",
   RowBox[{
    RowBox[{"Monitor`NestList", "[",
     RowBox[{
      RowBox[{
       RowBox[{"Transit", "[",
        RowBox[{"#", ",", "1"}], "]"}], "&"}], ",", "0", ",", "1000000"}],
     "]"}], "//", "Quiet"}]}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"ls0", "=",
   RowBox[{
    RowBox[{"Monitor`NestList", "[",
     RowBox[{
      RowBox[{
       RowBox[{"Transit", "[",
        RowBox[{"#", ",", "0.001"}], "]"}], "&"}], ",", "0", ",", "1000000"}],
      "]"}], "//", "Quiet"}]}], ";"}], "\[IndentingNewLine]",
 RowBox[{"GraphicsRow", "[",
  RowBox[{"{",
   RowBox[{
    RowBox[{"myhist", "[", "ls1", "]"}], ",",
    RowBox[{"myhist", "[", "ls0", "]"}]}], "}"}], "]"}]}], "Input"]
}]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Transit", "[",
   RowBox[{
    RowBox[{"{",
     RowBox[{"n1_", ",", "n2_"}], "}"}], ",",
    RowBox[{"n0_", ":", "1"}]}], "]"}], ":=",
  RowBox[{"RandomChoice", "[",
   RowBox[{
    RowBox[{"{",
     RowBox[{
      RowBox[{"1", "/", "2"}], ",",
      RowBox[{"1", "/", "2"}], ",",
      RowBox[{
       RowBox[{"(",
        RowBox[{"1", "-",
         SuperscriptBox["\[ExponentialE]",
          RowBox[{
           RowBox[{"-", "n1"}], "/", "n0"}]]}], ")"}],
       RowBox[{"(",
        RowBox[{"1", "+",
         SuperscriptBox["\[ExponentialE]",
          RowBox[{
           RowBox[{"-", "n2"}], "/", "n0"}]]}], ")"}]}], ",",
      RowBox[{
       RowBox[{"(",
        RowBox[{"1", "+",
         SuperscriptBox["\[ExponentialE]",
          RowBox[{
           RowBox[{"-", "n1"}], "/", "n0"}]]}], ")"}],
       RowBox[{"(",
        RowBox[{"1", "-",
         SuperscriptBox["\[ExponentialE]",
          RowBox[{
           RowBox[{"-", "n2"}], "/", "n0"}]]}], ")"}]}]}], "}"}],
    "\[RuleDelayed]",
    RowBox[{"{",
     RowBox[{
      RowBox[{"{",
       RowBox[{
        RowBox[{"n1", "+", "1"}], ",", "n2"}], "}"}], ",",
      RowBox[{"{",
       RowBox[{"n1", ",",
        RowBox[{"n2", "+", "1"}]}], "}"}], ",",
      RowBox[{"{",
       RowBox[{
        RowBox[{"n1", "-", "1"}], ",", "n2"}], "}"}], ",",
      RowBox[{"{",
       RowBox[{"n1", ",",
        RowBox[{"n2", "-", "1"}]}], "}"}]}], "}"}]}],
   "]"}]}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"ls11", "=",
   RowBox[{
    RowBox[{"Monitor`NestList", "[",
     RowBox[{
      RowBox[{
       RowBox[{"Transit", "[",
        RowBox[{"#", ",", "1"}], "]"}], "&"}], ",",
      RowBox[{"{",
       RowBox[{"0", ",", "0"}], "}"}], ",", "10000000"}], "]"}], "//",
    "Quiet"}]}], ";"}]}], "Input"]
}]],

Cell[CellGroupData[{

Cell["Simulations", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Transit", "[",
   RowBox[{
    RowBox[{"{",
     RowBox[{"n1_", ",", "n2_"}], "}"}], ",",
    RowBox[{"n0_", ":", "1"}]}], "]"}], ":=",
  RowBox[{"RandomChoice", "[",
   RowBox[{
    RowBox[{"{",
     RowBox[{
      RowBox[{"1", "/", "2"}], ",",
      RowBox[{"1", "/", "2"}], ",",
      RowBox[{
       RowBox[{"(",
        RowBox[{"1", "-",
         SuperscriptBox["\[ExponentialE]",
          RowBox[{
           RowBox[{"-", "n1"}], "/", "n0"}]]}], ")"}],
       RowBox[{"(",
        RowBox[{"1", "+",
         SuperscriptBox["\[ExponentialE]",
          RowBox[{
           RowBox[{"-", "n2"}], "/", "n0"}]]}], ")"}]}], ",",
      RowBox[{
       RowBox[{"(",
        RowBox[{"1", "+",
         SuperscriptBox["\[ExponentialE]",
          RowBox[{
           RowBox[{"-", "n1"}], "/", "n0"}]]}], ")"}],
       RowBox[{"(",
        RowBox[{"1", "-",
         SuperscriptBox["\[ExponentialE]",
          RowBox[{
           RowBox[{"-", "n2"}], "/", "n0"}]]}], ")"}]}]}], "}"}],
    "\[RuleDelayed]",
    RowBox[{"{",
     RowBox[{
      RowBox[{"{",
       RowBox[{
        RowBox[{"n1", "+", "1"}], ",", "n2"}], "}"}], ",",
      RowBox[{"{",
       RowBox[{"n1", ",",
        RowBox[{"n2", "+", "1"}]}], "}"}], ",",
      RowBox[{"{",
       RowBox[{
        RowBox[{"n1", "-", "1"}], ",", "n2"}], "}"}], ",",
      RowBox[{"{",
       RowBox[{"n1", ",",
        RowBox[{"n2", "-", "1"}]}], "}"}]}], "}"}]}],
   "]"}]}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"ls11", "=",
   RowBox[{
    RowBox[{"Monitor`NestList", "[",
     RowBox[{
      RowBox[{
       RowBox[{"Transit", "[",
        RowBox[{"#", ",", "1"}], "]"}], "&"}], ",",
      RowBox[{"{",
       RowBox[{"0", ",", "0"}], "}"}], ",", "10000000"}], "]"}], "//",
    "Quiet"}]}], ";"}], "\[IndentingNewLine]",
 RowBox[{"Histogram3D", "[",
  RowBox[{"ls11", ",",
   RowBox[{"ColorFunction", "\[Rule]", "\"\<TemperatureMap\>\""}]}],
  "]"}]}], "Input"]
}]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Transit", "[",
   RowBox[{
    RowBox[{"{",
     RowBox[{"n1_", ",", "n2_"}], "}"}], ",",
    RowBox[{"n0_", ":", "1"}]}], "]"}], ":=",
  RowBox[{"RandomChoice", "[",
   RowBox[{
    RowBox[{"{",
     RowBox[{
      RowBox[{"1", "/", "2"}], ",",
      RowBox[{"1", "/", "2"}], ",",
      RowBox[{
       RowBox[{"(",
        RowBox[{"1", "+",
         SuperscriptBox["\[ExponentialE]",
          RowBox[{
           RowBox[{"-", "n2"}], "/", "n0"}]]}], ")"}],
       RowBox[{"(",
        RowBox[{"1", "-",
         SuperscriptBox["\[ExponentialE]",
          RowBox[{
           RowBox[{"-", "n1"}], "/", "n0"}]]}], ")"}]}], ",",
      RowBox[{
       RowBox[{"(",
        RowBox[{"1", "+",
         SuperscriptBox["\[ExponentialE]",
          RowBox[{
           RowBox[{"-", "n1"}], "/", "n0"}]]}], ")"}],
       RowBox[{"(",
        RowBox[{"1", "-",
         SuperscriptBox["\[ExponentialE]",
          RowBox[{
           RowBox[{"-", "n2"}], "/", "n0"}]]}], ")"}]}]}], "}"}],
    "\[RuleDelayed]",
    RowBox[{"{",
     RowBox[{
      RowBox[{"{",
       RowBox[{
        RowBox[{"n1", "+", "1"}], ",", "n2"}], "}"}], ",",
      RowBox[{"{",
       RowBox[{"n1", ",",
        RowBox[{"n2", "+", "1"}]}], "}"}], ",",
      RowBox[{"{",
       RowBox[{
        RowBox[{"n1", "-", "1"}], ",", "n2"}], "}"}], ",",
      RowBox[{"{",
       RowBox[{"n1", ",",
        RowBox[{"n2", "-", "1"}]}], "}"}]}], "}"}]}],
   "]"}]}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"ls00", "=",
   RowBox[{
    RowBox[{"nestListWithMonitor", "[",
     RowBox[{
      RowBox[{
       RowBox[{"Transit", "[",
        RowBox[{"#", ",", "0.01"}], "]"}], "&"}], ",",
      RowBox[{"{",
       RowBox[{"0", ",", "0"}], "}"}], ",", "10000000"}], "]"}], "//",
    "Quiet"}]}], ";"}], "\[IndentingNewLine]",
 RowBox[{"Histogram3D", "[",
  RowBox[{"ls00", ",",
   RowBox[{"ColorFunction", "\[Rule]", "\"\<TemperatureMap\>\""}]}],
  "]"}]}], "Input"]
}]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Transit", "[",
   RowBox[{
    RowBox[{"{",
     RowBox[{"n1_", ",", "n2_"}], "}"}], ",",
    RowBox[{"n0_", ":", "1"}]}], "]"}], ":=",
  RowBox[{"RandomChoice", "[",
   RowBox[{
    RowBox[{"{",
     RowBox[{
      RowBox[{"1", "/", "2"}], ",",
      RowBox[{"1", "/", "2"}], ",",
      RowBox[{
       FractionBox["2", "11"],
       RowBox[{"(",
        RowBox[{"1", "+",
         RowBox[{"10",
          SuperscriptBox["\[ExponentialE]",
           RowBox[{
            RowBox[{"-", "n2"}], "/", "n0"}]]}]}], ")"}],
       RowBox[{"(",
        RowBox[{"1", "-",
         SuperscriptBox["\[ExponentialE]",
          RowBox[{
           RowBox[{"-", "n1"}], "/", "n0"}]]}], ")"}]}], ",",
      RowBox[{
       FractionBox["2", "11"],
       RowBox[{"(",
        RowBox[{"10", "+",
         SuperscriptBox["\[ExponentialE]",
          RowBox[{
           RowBox[{"-", "n1"}], "/", "n0"}]]}], ")"}],
       RowBox[{"(",
        RowBox[{"1", "-",
         SuperscriptBox["\[ExponentialE]",
          RowBox[{
           RowBox[{"-", "n2"}], "/", "n0"}]]}], ")"}]}]}], "}"}],
    "\[RuleDelayed]",
    RowBox[{"{",
     RowBox[{
      RowBox[{"{",
       RowBox[{
        RowBox[{"n1", "+", "1"}], ",", "n2"}], "}"}], ",",
      RowBox[{"{",
       RowBox[{"n1", ",",
        RowBox[{"n2", "+", "1"}]}], "}"}], ",",
      RowBox[{"{",
       RowBox[{
        RowBox[{"n1", "-", "1"}], ",", "n2"}], "}"}], ",",
      RowBox[{"{",
       RowBox[{"n1", ",",
        RowBox[{"n2", "-", "1"}]}], "}"}]}], "}"}]}],
   "]"}]}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"ls11", "=",
   RowBox[{
    RowBox[{"nestListWithMonitor", "[",
     RowBox[{
      RowBox[{
       RowBox[{"Transit", "[",
        RowBox[{"#", ",", "1"}], "]"}], "&"}], ",",
      RowBox[{"{",
       RowBox[{"0", ",", "0"}], "}"}], ",", "10"}], "]"}], "//", "Quiet"}]}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{"Histogram3D", "[",
  RowBox[{"ls11", ",",
   RowBox[{"ColorFunction", "\[Rule]", "\"\<TemperatureMap\>\""}]}],
  "]"}]}], "Input"]
}]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Transit", "[",
   RowBox[{
    RowBox[{"{",
     RowBox[{"n1_", ",", "n2_"}], "}"}], ",",
    RowBox[{"n0_", ":", "1"}]}], "]"}], ":=",
  RowBox[{"RandomChoice", "[",
   RowBox[{
    RowBox[{"{",
     RowBox[{
      RowBox[{"1", "/", "2"}], ",",
      RowBox[{"1", "/", "2"}], ",",
      RowBox[{
       FractionBox["2", "11"],
       RowBox[{"(",
        RowBox[{"1", "+",
         RowBox[{"10",
          SuperscriptBox["\[ExponentialE]",
           RowBox[{
            RowBox[{"-", "n2"}], "/", "n0"}]]}]}], ")"}],
       RowBox[{"(",
        RowBox[{"1", "-",
         SuperscriptBox["\[ExponentialE]",
          RowBox[{
           RowBox[{"-", "n1"}], "/", "n0"}]]}], ")"}]}], ",",
      RowBox[{
       FractionBox["2", "11"],
       RowBox[{"(",
        RowBox[{"10", "+",
         SuperscriptBox["\[ExponentialE]",
          RowBox[{
           RowBox[{"-", "n1"}], "/", "n0"}]]}], ")"}],
       RowBox[{"(",
        RowBox[{"1", "-",
         SuperscriptBox["\[ExponentialE]",
          RowBox[{
           RowBox[{"-", "n2"}], "/", "n0"}]]}], ")"}]}]}], "}"}],
    "\[RuleDelayed]",
    RowBox[{"{",
     RowBox[{
      RowBox[{"{",
       RowBox[{
        RowBox[{"n1", "+", "1"}], ",", "n2"}], "}"}], ",",
      RowBox[{"{",
       RowBox[{"n1", ",",
        RowBox[{"n2", "+", "1"}]}], "}"}], ",",
      RowBox[{"{",
       RowBox[{
        RowBox[{"n1", "-", "1"}], ",", "n2"}], "}"}], ",",
      RowBox[{"{",
       RowBox[{"n1", ",",
        RowBox[{"n2", "-", "1"}]}], "}"}]}], "}"}]}],
   "]"}]}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"ls00", "=",
   RowBox[{
    RowBox[{"nestListWithMonitor", "[",
     RowBox[{
      RowBox[{
       RowBox[{"Transit", "[",
        RowBox[{"#", ",", "0.01"}], "]"}], "&"}], ",",
      RowBox[{"{",
       RowBox[{"0", ",", "0"}], "}"}], ",", "10000000"}], "]"}], "//",
    "Quiet"}]}], ";"}], "\[IndentingNewLine]",
 RowBox[{"Histogram3D", "[",
  RowBox[{"ls00", ",",
   RowBox[{"ColorFunction", "\[Rule]", "\"\<TemperatureMap\>\""}]}],
  "]"}]}], "Input"]
}]],

Cell["\<\
Binomial - Poisson entropic inequalities and the M/M/\[Infinity] \
queueBinomial - Poisson entropic inequalities and the M/M/\[Infinity] queue\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData["$PreRead"], "Input"]
}]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RandomReal", "[", "]"}]], "Input"]
}]]
}]]
}]],

Cell[CellGroupData[{

Cell["Correlation", "Section"],

Cell[CellGroupData[{

Cell["Copula", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot3D", "[",
  RowBox[{
   RowBox[{"Min", "[",
    RowBox[{"x", ",", "y"}], "]"}], ",",
   RowBox[{"{",
    RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",",
   RowBox[{"{",
    RowBox[{"y", ",", "0", ",", "1"}], "}"}]}], "]"}]], "Input"]
}]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CorrelationFunction", "[",
     RowBox[{"#", ",",
      RowBox[{"{", "5", "}"}]}], "]"}], "&"}], "/@", "data"}], "//",
  "ListLinePlot"}]], "Input"]
}]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"CorrelationFunction", "[",
  RowBox[{
   RowBox[{"BinomialProcess", "[", "p", "]"}], ",", "s", ",", "t"}],
  "]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"Flatten", "[",
   RowBox[{
    RowBox[{"Table", "[",
     RowBox[{
      RowBox[{"{",
       RowBox[{"s", ",", "t", ",",
        RowBox[{"Evaluate", "[",
         RowBox[{"%", "/.",
          RowBox[{"(",
           RowBox[{"p", "\[Rule]",
            RowBox[{"2", "/", "3"}]}], ")"}]}], "]"}]}], "}"}], ",",
      RowBox[{"{",
       RowBox[{"s", ",", "1", ",", "10"}], "}"}], ",",
      RowBox[{"{",
       RowBox[{"t", ",", "1", ",", "10"}], "}"}]}], "]"}], ",", "1"}], "]"}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{"Show", "[",
  RowBox[{
   RowBox[{"Plot3D", "[",
    RowBox[{
     RowBox[{"Evaluate", "[",
      RowBox[{"%%", "/.",
       RowBox[{"(",
        RowBox[{"p", "\[Rule]",
         RowBox[{"2", "/", "3"}]}], ")"}]}], "]"}], ",",
     RowBox[{"{",
      RowBox[{"s", ",", "1", ",", "10"}], "}"}], ",",
     RowBox[{"{",
      RowBox[{"t", ",", "1", ",", "10"}], "}"}], ",",
     RowBox[{"Exclusions", "\[Rule]", "None"}]}], "]"}], ",",
   RowBox[{"ListPointPlot3D", "[", "%", "]"}]}], "]"}]}], "Input"]
}]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Max", "[",
   RowBox[{
    RowBox[{
     RowBox[{"Max", "[",
      RowBox[{
       RowBox[{"(",
        RowBox[{"w", "+", "x"}], ")"}], ",", "0"}], "]"}], "+", "x2"}], ",",
    "0"}], "]"}], "//", "FullSimplify"}]], "Input"]
}]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Reduce", "[",
  RowBox[{
   RowBox[{
    RowBox[{"Max", "[",
     RowBox[{
      RowBox[{
       RowBox[{"Max", "[",
        RowBox[{
         RowBox[{"(",
          RowBox[{"w", "+", "x"}], ")"}], ",", "0"}], "]"}], "+", "x2"}], ",",
       "0"}], "]"}], "\[Equal]", "0"}], ",", "x2"}], "]"}]], "Input"]
}]],

Cell[BoxData[
 RowBox[{"DensityPlot3D", "[",
  RowBox[{
   RowBox[{"{",
    RowBox[{"Max", "[",
     RowBox[{
      RowBox[{
       RowBox[{"Max", "[",
        RowBox[{"w", ",", "0"}], "]"}], "+", "x"}], ",", "0"}], "]"}], "}"}],
   ",",
   RowBox[{"{",
    RowBox[{"w", ",", "0", ",", "1"}], "}"}], ",",
   RowBox[{"{",
    RowBox[{"x", ",",
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",",
   RowBox[{"AxesLabel", "\[Rule]", "Automatic"}], ",",
   RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",",
   RowBox[{"OpacityFunction", "\[Rule]",
    RowBox[{"(",
     RowBox[{
      RowBox[{
       RowBox[{"Max", "[",
        RowBox[{"#", ",", "0"}], "]"}], "/", "4"}], "&"}], ")"}]}], ",",
   RowBox[{"OpacityFunctionScaling", "\[Rule]", "False"}]}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[",
  RowBox[{
   RowBox[{"DensityPlot3D", "[",
    RowBox[{
     RowBox[{"{",
      RowBox[{"Max", "[",
       RowBox[{
        RowBox[{
         RowBox[{"Max", "[",
          RowBox[{
           RowBox[{"(",
            RowBox[{"w", "+", "x"}], ")"}], ",", "0"}], "]"}], "+", "x2"}],
        ",", "0"}], "]"}], "}"}], ",",
     RowBox[{"{",
      RowBox[{"w", ",", "0", ",", "1"}], "}"}], ",",
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"-", "1"}], ",", "0"}], "}"}], ",",
     RowBox[{"{",
      RowBox[{"x2", ",",
       RowBox[{"-", ".5"}], ",", ".5"}], "}"}], ",",
     RowBox[{"AxesLabel", "\[Rule]",
      RowBox[{"{",
       RowBox[{"\"\<w\>\"", ",", "\"\<x\>\"", ",", "\"\<x2\>\""}], "}"}]}],
     ",",
     RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",",
     RowBox[{"OpacityFunction", "\[Rule]",
      RowBox[{"(",
       RowBox[{
        RowBox[{
         RowBox[{"Max", "[",
          RowBox[{"#", ",", "0"}], "]"}], "/", "4"}], "&"}], ")"}]}], ",",
     RowBox[{"OpacityFunctionScaling", "\[Rule]", "False"}]}], "]"}], ",",
   "\[IndentingNewLine]",
   RowBox[{"ContourPlot3D", "[",
    RowBox[{
     RowBox[{"{",
      RowBox[{
       RowBox[{
        RowBox[{"w", "+", "x", "+", "x2"}], "\[Equal]", "0"}], ",",
       RowBox[{
        RowBox[{"w", "+", "x"}], "\[Equal]", "0"}], ",",
       RowBox[{"x2", "\[Equal]", "0"}]}], "}"}], ",",
     RowBox[{"{",
      RowBox[{"w", ",", "0", ",", "1"}], "}"}], ",",
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"-", "1"}], ",", "0"}], "}"}], ",",
     RowBox[{"{",
      RowBox[{"x2", ",",
       RowBox[{"-", ".5"}], ",", "5"}], "}"}], ",",
     RowBox[{"ContourStyle", "\[Rule]",
      RowBox[{"Opacity", "[", "0.1", "]"}]}], ",",
     RowBox[{"RegionBoundaryStyle", "\[Rule]", "None"}], ",",
     RowBox[{"RegionFunction", "\[Rule]",
      RowBox[{"Function", "[",
       RowBox[{
        RowBox[{"{",
         RowBox[{"w", ",", "x", ",", "x2"}], "}"}], ",",
        RowBox[{
         RowBox[{"(",
          RowBox[{
           RowBox[{"x2", "\[GreaterEqual]", "0"}], "&&",
           RowBox[{
            RowBox[{"Abs", "[",
             RowBox[{"w", "+", "x"}], "]"}], "<", "1*^-2"}]}], ")"}], "||",
         RowBox[{"(",
          RowBox[{
           RowBox[{"x2", "<",
            RowBox[{"-", "1*^-9"}]}], "&&",
           RowBox[{
            RowBox[{"w", "+", "x"}], ">", "1*^-2"}]}], ")"}], "||",
         RowBox[{"(",
          RowBox[{
           RowBox[{
            RowBox[{"w", "+", "x"}], "\[LessEqual]", "0"}], "&&",
           RowBox[{
            RowBox[{"Abs", "[", "x2", "]"}], "<", "1*^-2"}]}], ")"}]}]}],
       "]"}]}]}], "]"}], ",", "\[IndentingNewLine]",
   RowBox[{"ParametricPlot3D", "[",
    RowBox[{
     RowBox[{"{",
      RowBox[{"w", ",",
       RowBox[{"-", "w"}], ",", "0"}], "}"}], ",",
     RowBox[{"{",
      RowBox[{"w", ",", "0", ",", "1"}], "}"}], ",",
     RowBox[{"PlotStyle", "\[Rule]", "Black"}]}], "]"}]}], "]"}]], "Input"]
}]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[",
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]], "Input"]
}]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[",
  RowBox[{"\"\<Assets\\\\two-step-iteration.png\>\"", ",", "%26"}],
  "]"}]], "Input"]
}]]
}]],

Cell[CellGroupData[{

Cell["Native Expressions", "Subsection"],

Cell[CellGroupData[{

Cell["Native Example", "Subsubsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[ScriptCapitalH]", "=",
   RowBox[{"DiscreteMarkovProcess", "[",
    RowBox[{
     FormBox[
      RowBox[{"{",
       RowBox[{"0.5", ",", "0.5"}], "}"}],
      TraditionalForm], ",",
     FormBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0.7", "0.3"},
         {"0.25", "0.75"}
        },
        GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]},
            Offset[0.27999999999999997`]}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]},
            Offset[0.2]}}], "\[NoBreak]", ")"}],
      TraditionalForm]}], "]"}]}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"\[ScriptCapitalH]", "//=",
   RowBox[{
    RowBox[{"ReplacePart", "[",
     RowBox[{"#", ",",
      RowBox[{"1", "\[Rule]",
       RowBox[{"(",
        RowBox[{
         RowBox[{
          RowBox[{"(",
           RowBox[{"#", "/",
            RowBox[{"Norm", "[",
             RowBox[{"#", ",", "1"}], "]"}]}], ")"}], "&"}], "@",
         RowBox[{"Array", "[",
          RowBox[{
           RowBox[{"PDF", "[",
            RowBox[{"StationaryDistribution", "[", "#", "]"}], "]"}], ",",
           RowBox[{"Length", "@",
            RowBox[{"MarkovProcessProperties", "[",
             RowBox[{"#", ",", "\"\<TransitionMatrix\>\""}], "]"}]}]}],
          "]"}]}], ")"}]}]}], "]"}], "&"}]}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"\[ScriptCapitalP]", "=",
   RowBox[{"HiddenMarkovProcess", "[",
    RowBox[{"\[ScriptCapitalH]", ",",
     RowBox[{"(", GridBox[{
        {"0.8", "0.2"},
        {"0.6", "0.4"}
       }], ")"}]}], "]"}]}], ";"}]}], "Input"]
}]],

Cell[CellGroupData[{

Cell["Pancy Example", "Subsubsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[ScriptCapitalD]0", "=",
   RowBox[{"(", GridBox[{
      {
       RowBox[{"-", "2"}], "0"},
      {"0",
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]}
     }], ")"}]}], ";",
  RowBox[{"\[ScriptCapitalD]1", "=",
   RowBox[{"(", GridBox[{
      {
       RowBox[{"3", "/", "5"}],
       RowBox[{"7", "/", "5"}]},
      {
       RowBox[{"7", "/", "20"}],
       RowBox[{"3", "/", "20"}]}
     }], ")"}]}], ";",
  RowBox[{"dt", "=", "1"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"transitM", "=",
   RowBox[{"N", "@",
    RowBox[{"MatrixExp", "[",
     RowBox[{"dt", " ",
      RowBox[{"(",
       RowBox[{"\[ScriptCapitalD]0", "+", "\[ScriptCapitalD]1"}], ")"}]}],
     "]"}]}]}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"emitM", "=",
   RowBox[{"N", "@",
    RowBox[{"MatrixExp", "[",
     RowBox[{"dt", " ", "\[ScriptCapitalD]1"}], "]"}]}]}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"\[ScriptCapitalH]", "=",
   RowBox[{"DiscreteMarkovProcess", "[",
    RowBox[{
     FormBox[
      RowBox[{"{",
       RowBox[{"0.5", ",", "0.5"}], "}"}],
      TraditionalForm], ",", "transitM"}], "]"}]}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"\[ScriptCapitalH]", "//=",
   RowBox[{
    RowBox[{"ReplacePart", "[",
     RowBox[{"#", ",",
      RowBox[{"1", "\[Rule]",
       RowBox[{"(",
        RowBox[{
         RowBox[{
          RowBox[{"(",
           RowBox[{"#", "/",
            RowBox[{"Norm", "[",
             RowBox[{"#", ",", "1"}], "]"}]}], ")"}], "&"}], "@",
         RowBox[{"Array", "[",
          RowBox[{
           RowBox[{"PDF", "[",
            RowBox[{"StationaryDistribution", "[", "#", "]"}], "]"}], ",",
           RowBox[{"Length", "@",
            RowBox[{"MarkovProcessProperties", "[",
             RowBox[{"#", ",", "\"\<TransitionMatrix\>\""}], "]"}]}]}],
          "]"}]}], ")"}]}]}], "]"}], "&"}]}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"\[ScriptCapitalP]", "=",
   RowBox[{"HiddenMarkovProcess", "[",
    RowBox[{"\[ScriptCapitalH]", ",",
     RowBox[{
      RowBox[{
       RowBox[{"(",
        RowBox[{"#", "/",
         RowBox[{"Total", "/@", "#"}]}], ")"}], "&"}], "@",
      "\[ScriptCapitalD]1"}]}], "]"}]}], ";"}]}], "Input"]
}]],

Cell[CellGroupData[{

Cell["Visualize Correlation", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"data", "=",
  RowBox[{"RandomFunction", "[",
   RowBox[{"\[ScriptCapitalP]", ",",
    RowBox[{"{",
     RowBox[{"1", ",", "1000"}], "}"}], ",", "10"}], "]"}]}]], "Input"]
}]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"TemporalData", "[",
  RowBox[{
   RowBox[{
    RowBox[{"Differences", "/@",
     RowBox[{
      RowBox[{"TemporalData", "[",
       RowBox[{
        RowBox[{
         RowBox[{"Append", "[",
          RowBox[{
           RowBox[{"DeleteDuplicatesBy", "[",
            RowBox[{"#", ",", "Last"}], "]"}], ",",
           RowBox[{"Last", "[", "#", "]"}]}], "]"}], "&"}], "/@",
        RowBox[{"(",
         RowBox[{
          RowBox[{"(",
           RowBox[{"Accumulate", "@",
            RowBox[{"(",
             RowBox[{"data", "-", "1"}], ")"}]}], ")"}], "[", "\"\<Paths\>\"",
           "]"}], ")"}]}], "]"}], "[", "\"\<TimeList\>\"", "]"}]}], "-",
    "1"}], ",", "Automatic"}], "]"}], "\[IndentingNewLine]",
 RowBox[{"GraphicsRow", "[",
  RowBox[{"{", "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"ListPlot", "[",
     RowBox[{"%", ",",
      RowBox[{"Filling", "\[Rule]", "Axis"}]}], "]"}], ",",
    "\[IndentingNewLine]",
    RowBox[{"ListPlot", "[",
     RowBox[{
      RowBox[{"CorrelationFunction", "[",
       RowBox[{"%", ",",
        RowBox[{"{", "5", "}"}]}], "]"}], ",",
      RowBox[{"Filling", "\[Rule]", "Axis"}], ",",
      RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}],
   "\[IndentingNewLine]", "}"}], "]"}]}], "Input"]
}]],

Cell[BoxData[
 RowBox[{"QueueingProcess", "[", "]"}]], "Input"]
}]]
}]]
}]],

Cell["New stuff", "Section"]
}]
(* End of Notebook Content *)
